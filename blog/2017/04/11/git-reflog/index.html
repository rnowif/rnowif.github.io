<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Keep Calm and Use Git Reflog - Renaud Humbert-Labeaumaz</title>
  <meta name="author" content="Renaud Humbert-Labeaumaz">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://rnowif.github.io/blog/2017/04/11/git-reflog/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Renaud Humbert-Labeaumaz" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://rnowif.github.io/blog/2017/04/11/git-reflog/">
  <meta property="og:title" content="Keep Calm and Use Git Reflog - Renaud Humbert-Labeaumaz">
  

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-127790305-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      
        <header role="banner">
          <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Renaud Humbert-Labeaumaz</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li ><a href="/blog/archives">Archives</a></li>

            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="rnowif.github.io">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


        </header>
      
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Renaud Humbert-Labeaumaz" />
    
    <meta itemprop="url" content="https://rnowif.github.io" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-04-11T07:52:15+01:00"  data-updated="true" itemprop="datePublished dateCreated">Tue 11 Apr 2017,  7:52 AM</time>
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        Keep Calm and Use Git Reflog
        
    </h1>
    
  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><p>Git is a very powerful tool but it takes a fair amount of time to masterize it. It can be particuarly easy to break or lose things when you amend some commits, resolve conflicts or force push your changes.</p>

<p>In this blog post, I will show you how to use the <code>git reflog</code> command to retrieve commits that you thought you lost forever.</p>

<!-- more -->


<h2>Retrieve an amended commit</h2>

<p>The first use case I will show is when you amend a commit:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git init
</span><span class='line'>$ echo "Hello" &gt; hello.txt
</span><span class='line'>$ git add hello.txt && git commit -m "Add hello"
</span><span class='line'>$ echo "Hello!" &gt; hello.txt
</span><span class='line'>$ git add hello.txt && git commit --amend</span></code></pre></td></tr></table></div></figure>


<p>If you think that the first commit is lost, read on.</p>

<p>The <code>git reflog</code> command allows you to display all git commands that you performed on your repo and, most importantly, the associated commit hash. In fact, these commits are not lost, they are just not in the tree anymore but you can still check them out, cherry-pick them or do whatever you need to do.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git reflog
</span><span class='line'>3e6e190 HEAD@{0}: commit (amend): Add hello
</span><span class='line'>51587bc HEAD@{1}: commit (initial): Add hello
</span><span class='line'>$ git diff 51587bc 3e6e190
</span><span class='line'>diff --git a/hello.txt b/hello.txt
</span><span class='line'>index e965047..10ddd6d 100644
</span><span class='line'>--- a/hello.txt
</span><span class='line'>+++ b/hello.txt
</span><span class='line'>@@ -1 +1 @@
</span><span class='line'>-Hello
</span><span class='line'>+Hello!</span></code></pre></td></tr></table></div></figure>


<h2>Recover an erroneous merge</h2>

<p>The second scenario is when you rebase a branch on an other one and you have conflicts.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git checkout -b develop
</span><span class='line'>$ git checkout master
</span><span class='line'>$ echo "Hello, world!" &gt; hello.txt
</span><span class='line'>$ git add hello.txt && git commit -m "Hello, world!"
</span><span class='line'>$ git checkout develop
</span><span class='line'>$ echo "Hello, you!" &gt; hello.txt
</span><span class='line'>$ git add hello.txt && git commit -m "Hello, you!"
</span><span class='line'>$ echo "World!" &gt; world.txt
</span><span class='line'>$ git add world.txt && git commit -m "Add world.txt"</span></code></pre></td></tr></table></div></figure>


<p>This is the resulting tree (note that the hello.txt has been modified on the two branches and there is a conflict):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>* a5c7ca5 - (HEAD -&gt; develop) Hello, you!
</span><span class='line'>| * 4d016c5 - (master) Hello, world!
</span><span class='line'>|/  
</span><span class='line'>* 3e6e190 - Add hello</span></code></pre></td></tr></table></div></figure>


<p>Unsurprisingly, the <code>reflog</code> looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git reflog
</span><span class='line'>21c2ce2 HEAD@{0}: commit: Add world.txt
</span><span class='line'>a5c7ca5 HEAD@{1}: commit: Hello, you!
</span><span class='line'>3e6e190 HEAD@{2}: checkout: moving from master to develop
</span><span class='line'>4d016c5 HEAD@{3}: commit: Hello, world!
</span><span class='line'>3e6e190 HEAD@{4}: checkout: moving from develop to master
</span><span class='line'>3e6e190 HEAD@{5}: checkout: moving from master to develop
</span><span class='line'>3e6e190 HEAD@{6}: commit (amend): Add hello
</span><span class='line'>51587bc HEAD@{7}: commit (initial): Add hello</span></code></pre></td></tr></table></div></figure>


<p>Now we rebase <code>develop</code> on <code>master</code> and we resolve the conflicts.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git rebase master
</span><span class='line'>// ... resolve merge conflicts</span></code></pre></td></tr></table></div></figure>


<p>The thing is that we made a mistake and took the wrong version of <code>hello.txt</code>. Since we did a rebase, we rewrote the history and we could think we lost the &ldquo;good&rdquo; version of <code>hello.txt</code>.</p>

<p><img src="/images/git-reflog.png"></p>

<p>In fact, the <code>reflog</code> will display a line for each commit you rebased so it is very easy to pick the one where you made a mistake.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git reflog
</span><span class='line'>ae9d1d8 HEAD@{0}: rebase finished: returning to refs/heads/develop
</span><span class='line'>ae9d1d8 HEAD@{1}: rebase: Add world.txt
</span><span class='line'>4d016c5 HEAD@{2}: rebase: checkout master
</span><span class='line'>21c2ce2 HEAD@{3}: commit: Add world.txt
</span><span class='line'>a5c7ca5 HEAD@{4}: commit: Hello, you!
</span><span class='line'>$ git diff 21c2ce2
</span><span class='line'>diff --git c/hello.txt w/hello.txt
</span><span class='line'>index 624d875..af5626b 100644
</span><span class='line'>--- c/hello.txt
</span><span class='line'>+++ w/hello.txt
</span><span class='line'>@@ -1 +1 @@
</span><span class='line'>-Hello, you!
</span><span class='line'>+Hello, world!</span></code></pre></td></tr></table></div></figure>


<p>If you want to go back and fix it, you just have to check the commit out, delete the current <code>develop</code> branch (since it is not in the correct state) and create a new <code>develop</code> branch based upon the right commit.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git checkout 21c2ce2
</span><span class='line'>$ git branch -D develop
</span><span class='line'>$ git checkout -b develop</span></code></pre></td></tr></table></div></figure>


<h2>Conclusion</h2>

<p>I think you got the idea, Git keeps everything that you committed. Thus, don&rsquo;t panic if you find yourself in a situation where you erase a previous commit and think about the <code>git reflog</code> command to dive into your history and look for the information you thought you lost!</p>
</div>


      <footer class="post-footer">
        <p class="meta text-muted">
          
  



<figure class="author-image">
    <span class="img" href="/about" style="background-image: url(/images/renaud.png)"><span class="hidden">Picture</span></span>
</figure>

<section class="author">
    <h4><span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="fn" itemprop="name">Renaud Humbert-Labeaumaz</span></span></h4>

    <a class="fa fa-link" href="https://rnowif.github.io">
        <span class="hidden">https://rnowif.github.io</span>
    </a>
    <a class="fa fa-twitter" href="https://twitter.com/rnowif">
        <span class="hidden">rnowif</span>
    </a>
    <a class="fa fa-github" href="https://github.com/rnowif">
        <span class="hidden">rnowif</span>
    </a>
</section>

<hr>

<section class="share">
    
    <h4>Share this post</h4>
    
    <a class="fa fa-twitter" href="https://twitter.com/intent/tweet?url=https://rnowif.github.io/blog/2017/04/11/git-reflog/;"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="fa fa-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://rnowif.github.io/blog/2017/04/11/git-reflog/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="fa fa-google-plus" href="https://plus.google.com/share?url=https://rnowif.github.io/blog/2017/04/11/git-reflog/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
    
</section>




<!--
<footer class="post-footer">


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Instant%20Movie%20Streamer%20v3%20Release&amp;url=http://iyask.me/instant-movie-streamer-v3-release/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://iyask.me/instant-movie-streamer-v3-release/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://iyask.me/instant-movie-streamer-v3-release/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>


-->

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-04-11T07:52:15+01:00"  data-updated="true" itemprop="datePublished dateCreated">Tue 11 Apr 2017,  7:52 AM</time>
          <br>

<span class="glyphicon glyphicon-tags"></span>&nbsp;
<span class="categories">
  
    <a class='category' href='/blog/categories/git/'>git</a>
  
</span>


        </p>
        
          <div class="pager">
            
            
              
                <a href="/blog/2017/04/10/trivia-refactoring/" class="col-xs-12 col-md-4 btn btn-default" title="Previous Post: Trivia Kata: A Refactoring Story"> 
                  <div class="text-muted">
                    <small>Previous Post</small>
                  </div>
                  <div class="pager-title">
                    <h4>Trivia Kata: A Refactoring Story</h4>
                  </div>
                </a>
              
            
            
            
              
              <a href="/blog/2017/07/20/controlling-time-in-java/" class="col-xs-12 col-md-4 btn btn-default pull-right" title="Next Post: Controlling the Time in Java">
                <div class="text-muted">
                  <small>Next Post</small>
                </div>
                <div class="pager-title">
                  <h4>Controlling the Time in Java</h4>
                </div>
              </a>
              
            
            
          </div>
        
      </footer>
    </article>
    
      <section>
        <h2>Comments</h2>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2020 - Renaud Humbert-Labeaumaz<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/bhrigu123/abacus">abacus theme</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'rnowif';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://rnowif.github.io/blog/2017/04/11/git-reflog/';
        var disqus_url = 'https://rnowif.github.io/blog/2017/04/11/git-reflog/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


  </body>
</html>
