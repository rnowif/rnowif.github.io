<!DOCTYPE html><html lang="en-ca"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Keep Calm and Use Git Reflog - A Software Gardener</title><meta name="description" content="Git is a very powerful tool but it takes a fair amount of time to masterize it. It can be particuarly easy to break or lose things when you amend some commits, resolve conflicts or force push your changes. In this blog post, I will&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://rnowif.github.io/keep-calm-and-use-git-reflog.html"><link rel="alternate" type="application/atom+xml" href="https://rnowif.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://rnowif.github.io/feed.json"><meta property="og:title" content="Keep Calm and Use Git Reflog"><meta property="og:image" content="https://rnowif.github.io/media/posts/10/hulki-okan-tabak-T9HLn-g6Cmo-unsplash.jpg"><meta property="og:site_name" content="A Software Gardener"><meta property="og:description" content="Git is a very powerful tool but it takes a fair amount of time to masterize it. It can be particuarly easy to break or lose things when you amend some commits, resolve conflicts or force push your changes. In this blog post, I will&hellip;"><meta property="og:url" content="https://rnowif.github.io/keep-calm-and-use-git-reflog.html"><meta property="og:type" content="article"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://rnowif.github.io/assets/css/style.css?v=1d9126d5c592483966037cf187b30969"><link rel="stylesheet" href="https://rnowif.github.io/assets/css/prism.css?v=a9de1acca9c12df6ea0d5f1bf5f5f4c7"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://rnowif.github.io/keep-calm-and-use-git-reflog.html"},"headline":"Keep Calm and Use Git Reflog","datePublished":"2017-04-11T11:30","dateModified":"2021-01-11T11:33","image":{"@type":"ImageObject","url":"https://rnowif.github.io/media/posts/10/hulki-okan-tabak-T9HLn-g6Cmo-unsplash.jpg","height":3500,"width":5250},"description":"Git is a very powerful tool but it takes a fair amount of time to masterize it. It can be particuarly easy to break or lose things when you amend some commits, resolve conflicts or force push your changes. In this blog post, I will&hellip;","author":{"@type":"Person","name":"Renaud Humbert-Labeaumaz"},"publisher":{"@type":"Organization","name":"Renaud Humbert-Labeaumaz"}}</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://rnowif.github.io/">A Software Gardener</a></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://rnowif.github.io/media/posts/10/hulki-okan-tabak-T9HLn-g6Cmo-unsplash.jpg" srcset="https://rnowif.github.io/media/posts/10/responsive/hulki-okan-tabak-T9HLn-g6Cmo-unsplash-xs.jpg 300w, https://rnowif.github.io/media/posts/10/responsive/hulki-okan-tabak-T9HLn-g6Cmo-unsplash-sm.jpg 480w, https://rnowif.github.io/media/posts/10/responsive/hulki-okan-tabak-T9HLn-g6Cmo-unsplash-md.jpg 768w, https://rnowif.github.io/media/posts/10/responsive/hulki-okan-tabak-T9HLn-g6Cmo-unsplash-lg.jpg 1024w, https://rnowif.github.io/media/posts/10/responsive/hulki-okan-tabak-T9HLn-g6Cmo-unsplash-xl.jpg 1360w, https://rnowif.github.io/media/posts/10/responsive/hulki-okan-tabak-T9HLn-g6Cmo-unsplash-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="3500" width="5250" alt=""><figcaption>https://unsplash.com/@hulkiokantabak</figcaption></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2017-04-11T11:30">April 11, 2017</time></div><h1>Keep Calm and Use Git Reflog</h1><div class="post__meta post__meta--author"><img src="https://rnowif.github.io/media/website/renaud.png" loading="eager" alt="Renaud Humbert-Labeaumaz" class="post__author-thumb"> <a href="https://rnowif.github.io/authors/renaud-humbert-labeaumaz/" class="feed__author invert">Renaud Humbert-Labeaumaz</a></div></div></header></div><div class="wrapper post__entry"><p>Git is a very powerful tool but it takes a fair amount of time to masterize it. It can be particuarly easy to break or lose things when you amend some commits, resolve conflicts or force push your changes.</p><p>In this blog post, I will show you how to use the <code>git reflog</code> command to retrieve commits that you thought you lost forever.</p><h2 id="retrieve-an-amended-commit">Retrieve an amended commit</h2><p>The first use case I will show is when you amend a commit:</p><pre><code>$ git init
$ echo &quot;Hello&quot; &gt; hello.txt
$ git add hello.txt &amp;&amp; git commit -m &quot;Add hello&quot;
$ echo &quot;Hello!&quot; &gt; hello.txt
$ git add hello.txt &amp;&amp; git commit --amend</code></pre><p>If you think that the first commit is lost, read on.</p><p>The <code>git reflog</code> command allows you to display all git commands that you performed on your repo and, most importantly, the associated commit hash. In fact, these commits are not lost, they are just not in the tree anymore but you can still check them out, cherry-pick them or do whatever you need to do.</p><pre><code>$ git reflog
3e6e190 HEAD@{0}: commit (amend): Add hello
51587bc HEAD@{1}: commit (initial): Add hello
$ git diff 51587bc 3e6e190
diff --git a/hello.txt b/hello.txt
index e965047..10ddd6d 100644
--- a/hello.txt
+++ b/hello.txt
@@ -1 +1 @@
-Hello
+Hello!</code></pre><h2 id="recover-an-erroneous-merge">Recover an erroneous merge</h2><p>The second scenario is when you rebase a branch on an other one and you have conflicts.</p><pre><code>$ git checkout -b develop
$ git checkout master
$ echo &quot;Hello, world!&quot; &gt; hello.txt
$ git add hello.txt &amp;&amp; git commit -m &quot;Hello, world!&quot;
$ git checkout develop
$ echo &quot;Hello, you!&quot; &gt; hello.txt
$ git add hello.txt &amp;&amp; git commit -m &quot;Hello, you!&quot;
$ echo &quot;World!&quot; &gt; world.txt
$ git add world.txt &amp;&amp; git commit -m &quot;Add world.txt&quot;</code></pre><p>This is the resulting tree (note that the hello.txt has been modified on the two branches and there is a conflict):</p><pre><code>* a5c7ca5 - (HEAD -&gt; develop) Hello, you!
| * 4d016c5 - (master) Hello, world!
|/  
* 3e6e190 - Add hello</code></pre><p>Unsurprisingly, the <code>reflog</code> looks like this:</p><pre><code>$ git reflog
21c2ce2 HEAD@{0}: commit: Add world.txt
a5c7ca5 HEAD@{1}: commit: Hello, you!
3e6e190 HEAD@{2}: checkout: moving from master to develop
4d016c5 HEAD@{3}: commit: Hello, world!
3e6e190 HEAD@{4}: checkout: moving from develop to master
3e6e190 HEAD@{5}: checkout: moving from master to develop
3e6e190 HEAD@{6}: commit (amend): Add hello
51587bc HEAD@{7}: commit (initial): Add hello</code></pre><p>Now we rebase <code>develop</code> on <code>master</code> and we resolve the conflicts.</p><pre><code>$ git rebase master
// ... resolve merge conflicts</code></pre><p>The thing is that we made a mistake and took the wrong version of <code>hello.txt</code>. Since we did a rebase, we rewrote the history and we could think we lost the “good” version of <code>hello.txt</code>.</p><p>{% img /images/git-reflog.png %}</p><p>In fact, the <code>reflog</code> will display a line for each commit you rebased so it is very easy to pick the one where you made a mistake.</p><pre><code>$ git reflog
ae9d1d8 HEAD@{0}: rebase finished: returning to refs/heads/develop
ae9d1d8 HEAD@{1}: rebase: Add world.txt
4d016c5 HEAD@{2}: rebase: checkout master
21c2ce2 HEAD@{3}: commit: Add world.txt
a5c7ca5 HEAD@{4}: commit: Hello, you!
$ git diff 21c2ce2
diff --git c/hello.txt w/hello.txt
index 624d875..af5626b 100644
--- c/hello.txt
+++ w/hello.txt
@@ -1 +1 @@
-Hello, you!
+Hello, world!</code></pre><p>If you want to go back and fix it, you just have to check the commit out, delete the current <code>develop</code> branch (since it is not in the correct state) and create a new <code>develop</code> branch based upon the right commit.</p><pre><code>$ git checkout 21c2ce2
$ git branch -D develop
$ git checkout -b develop</code></pre><h2 id="conclusion">Conclusion</h2><p>I think you got the idea, Git keeps everything that you committed. Thus, don’t panic if you find yourself in a situation where you erase a previous commit and think about the <code>git reflog</code> command to dive into your history and look for the information you thought you lost!</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on January 11, 2021</p><ul class="post__tag"><li><a href="https://rnowif.github.io/tags/git/">git</a></li></ul><div class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2Frnowif.github.io%2Fkeep-calm-and-use-git-reflog.html&amp;via=%40rnowif&amp;text=Keep%20Calm%20and%20Use%20Git%20Reflog" class="js-share twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://rnowif.github.io/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2Frnowif.github.io%2Fkeep-calm-and-use-git-reflog.html&amp;title=Keep%20Calm%20and%20Use%20Git%20Reflog" class="js-share linkedin" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://rnowif.github.io/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span></a></div><div class="post__bio bio"><img class="bio__avatar" src="https://rnowif.github.io/media/website/renaud.png" loading="lazy" alt="Renaud Humbert-Labeaumaz"><div class="bio__info"><h3 class="bio__name"><a href="https://rnowif.github.io/authors/renaud-humbert-labeaumaz/" class="invert" rel="author">Renaud Humbert-Labeaumaz</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://rnowif.github.io/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://rnowif.github.io/trivia-kata-a-refactoring-story.html" class="invert post__nav-link" rel="prev"><span>Previous</span> Trivia Kata: A Refactoring Story</a></div><div class="post__nav-next"><a href="https://rnowif.github.io/controlling-the-time-in-java.html" class="invert post__nav-link" rel="next"><span>Next</span> Controlling the Time in Java </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://rnowif.github.io/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__comments"><div class="wrapper"><h2 class="h5">Comments</h2><div id="disqus_thread"></div><script>var disqus_config = function () {
                       this.page.url = 'https://rnowif.github.io/keep-calm-and-use-git-reflog.html';
               		this.page.identifier = '10';
                   };
               
                   var disqus_loaded = false;
               
                   function publiiLoadDisqus() {
                       if(disqus_loaded) {
                           return false;
                       }
               
                       var top = document.getElementById('disqus_thread').offsetTop;
               
                       if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                           disqus_loaded = true;
               
                           (function () {
                               var d = document, s = d.createElement('script');
                               s.src = 'https://'+'rnowif'.trim()+'.disqus.com/embed.js';
                               s.setAttribute('data-timestamp', +new Date());
                               (d.head || d.body).appendChild(s);
                           })();
                       }
                   }
               
                   publiiLoadDisqus();
               
                   window.onscroll = function() {
                       publiiLoadDisqus();
                   };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener noreferrer">comments powered by Disqus.</a></noscript></div></div></main><footer class="footer"><div class="footer__social"><a href="https://twitter.com/rnowif" aria-label="Twitter"><svg><use xlink:href="https://rnowif.github.io/assets/svg/svg-map.svg#twitter"/></svg></a></div><div class="footer__copyright"><p>Renaud Humbert-Labeaumaz - 2021</p></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://rnowif.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://rnowif.github.io/assets/js/scripts.min.js?v=f4c4d35432d0e17d212f2fae4e0f8247"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://rnowif.github.io/assets/js/prism.js?v=8a3c962ef789bf5cc575d02e6a4bd4b2"></script></body></html>